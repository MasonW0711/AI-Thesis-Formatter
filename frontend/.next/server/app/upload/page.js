(()=>{var e={};e.id=676,e.ids=[676],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6502:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>m,pages:()=>c,routeModule:()=>h,tree:()=>o});var a=t(482),r=t(9108),i=t(2563),n=t.n(i),l=t(8300),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);t.d(s,d);let o=["",{children:["upload",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,1453)),"/Users/wangchunhao/github /AI-Thesis-Formatter/frontend/app/upload/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,2917)),"/Users/wangchunhao/github /AI-Thesis-Formatter/frontend/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9361,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/wangchunhao/github /AI-Thesis-Formatter/frontend/app/upload/page.tsx"],m="/upload/page",p={require:t,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/upload/page",pathname:"/upload",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},6187:()=>{},2351:(e,s,t)=>{Promise.resolve().then(t.bind(t,7339))},8779:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,2583,23)),Promise.resolve().then(t.t.bind(t,6840,23)),Promise.resolve().then(t.t.bind(t,8771,23)),Promise.resolve().then(t.t.bind(t,3225,23)),Promise.resolve().then(t.t.bind(t,9295,23)),Promise.resolve().then(t.t.bind(t,3982,23))},7339:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>n});var a=t(5344),r=t(3729),i=t(4767);function n(){var e;let[s,t]=(0,r.useState)("template"),[n,l]=(0,r.useState)(!1),[d,o]=(0,r.useState)(!1),[c,m]=(0,r.useState)(0),[p,h]=(0,r.useState)(null),[u,x]=(0,r.useState)([]),[g,v]=(0,r.useState)(null),[j,f]=(0,r.useState)(""),[y,b]=(0,r.useState)(null),[N,D]=(0,r.useState)(!1),w=(0,r.useRef)(null),C=(0,i.useRouter)();(0,r.useEffect)(()=>{k()},[]);let k=async()=>{try{let e=await fetch("/api/templates");if(e.ok){let s=await e.json();x(s.templates||[])}}catch(e){console.error("載入範本失敗:",e)}},P=(0,r.useCallback)(e=>{e.preventDefault(),l(!0)},[]),_=(0,r.useCallback)(e=>{e.preventDefault(),l(!1)},[]),S=(0,r.useCallback)(e=>{e.preventDefault(),l(!1);let s=e.dataTransfer.files;s.length>0&&W(s[0])},[s]),I=(0,r.useCallback)(e=>{let s=e.target.files;s&&s.length>0&&W(s[0])},[s]),W=async e=>{let a=e.name.toLowerCase();if(!a.endsWith(".pdf")&&!a.endsWith(".docx")&&!a.endsWith(".doc")){h("只支援 PDF 和 Word (.docx) 格式的文件");return}if(e.size>52428800){h("文件大小不能超過 50MB");return}h(null),o(!0),m(0);let r=new FormData;r.append("file",e);try{let e;let a=setInterval(()=>{m(e=>e>=90?(clearInterval(a),e):e+10)},200);if("template"===s){let s=`/api/templates/upload?name=${encodeURIComponent(j||"我的範本")}`;e=await fetch(s,{method:"POST",body:r})}else e=await fetch("/api/upload",{method:"POST",body:r});if(clearInterval(a),m(100),!e.ok){let s=await e.json();throw Error(s.detail||"上傳失敗")}let i=await e.json();"template"===s?(await k(),v({id:i.id,name:i.name,description:i.description,page_count:i.page_count,created_at:new Date().toISOString()}),t("thesis")):b(i),o(!1)}catch(e){h(e instanceof Error?e.message:"上傳失敗，請稍後再試"),o(!1),m(0)}},$=async()=>{if(y&&g){D(!0),t("processing"),h(null);try{let e=await fetch(`/api/documents/${y.id}/apply-template/${g.id}`,{method:"POST"});if(!e.ok){let s=await e.json();throw Error(s.detail||"處理失敗")}C.push("/documents")}catch(e){h(e instanceof Error?e.message:"處理失敗，請稍後再試"),D(!1),t("thesis")}}};return(0,a.jsxs)("div",{className:"container",style:{maxWidth:"800px",padding:"2rem 1.5rem"},children:[a.jsx("h1",{className:"text-center mb-6",children:"論文格式調整"}),(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"center",gap:"1rem",marginBottom:"2rem"},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",opacity:"template"===s?1:.5},children:[a.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"50%",background:"template"===s?"var(--gradient-primary)":"var(--success-500)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"bold"},children:"template"!==s?"✓":"1"}),a.jsx("span",{children:"上傳範本"})]}),a.jsx("div",{style:{width:"40px",height:"2px",background:"var(--gray-300)",margin:"auto 0"}}),(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",opacity:"thesis"===s?1:.5},children:[a.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"50%",background:"thesis"===s?"var(--gradient-primary)":"processing"===s?"var(--success-500)":"var(--gray-300)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"bold"},children:"processing"===s?"✓":"2"}),a.jsx("span",{children:"上傳論文"})]}),a.jsx("div",{style:{width:"40px",height:"2px",background:"var(--gray-300)",margin:"auto 0"}}),(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",opacity:"processing"===s?1:.5},children:[a.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"50%",background:"processing"===s?"var(--gradient-primary)":"var(--gray-300)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"bold"},children:"3"}),a.jsx("span",{children:"格式調整"})]})]}),p&&(0,a.jsxs)("div",{style:{padding:"1rem",background:"var(--error-500)",color:"white",borderRadius:"var(--radius)",marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:["⚠️ ",p]}),"template"===s&&(0,a.jsxs)("div",{className:"card animate-fade-in",children:[a.jsx("h3",{className:"mb-4",children:"\uD83D\uDCC4 步驟 1：上傳格式範本"}),a.jsx("p",{style:{color:"var(--gray-500)",marginBottom:"1.5rem"},children:"請上傳一份具有您想要格式的 PDF 文件（例如：學校提供的論文範例）"}),(0,a.jsxs)("div",{className:"mb-4",children:[a.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"500"},children:"範本名稱"}),a.jsx("input",{type:"text",value:j,onChange:e=>f(e.target.value),placeholder:"例如：學校論文格式",style:{width:"100%",padding:"0.75rem 1rem",border:"1px solid var(--gray-300)",borderRadius:"var(--radius)",fontSize:"1rem"}})]}),u.length>0&&(0,a.jsxs)("div",{className:"mb-4",children:[a.jsx("h4",{style:{marginBottom:"0.75rem"},children:"或選擇已有的範本："}),a.jsx("div",{className:"template-grid",children:u.map(e=>(0,a.jsxs)("div",{className:`template-card ${g?.id===e.id?"selected":""}`,onClick:()=>{v(e),t("thesis")},children:[(0,a.jsxs)("div",{className:"template-name",children:["\uD83D\uDCDA ",e.name]}),a.jsx("div",{className:"template-description",children:e.description})]},e.id))})]}),(0,a.jsxs)("div",{className:`upload-zone ${n?"drag-over":""}`,onDragOver:P,onDragLeave:_,onDrop:S,onClick:()=>w.current?.click(),children:[a.jsx("input",{ref:w,type:"file",accept:".pdf,.docx,.doc",onChange:I,style:{display:"none"}}),d?(0,a.jsxs)("div",{children:[a.jsx("div",{className:"upload-icon animate-spin",children:"\uD83D\uDCE4"}),a.jsx("h3",{className:"upload-title",children:"正在上傳並學習格式..."}),a.jsx("div",{className:"progress-bar",style:{maxWidth:"300px",margin:"1rem auto"},children:a.jsx("div",{className:"progress-fill",style:{width:`${c}%`}})})]}):(0,a.jsxs)("div",{children:[a.jsx("div",{className:"upload-icon",children:"\uD83D\uDCC4"}),a.jsx("h3",{className:"upload-title",children:"上傳格式範本"}),a.jsx("p",{className:"upload-subtitle",children:"支援 PDF 或 Word (.docx)"})]})]})]}),"thesis"===s&&g&&(0,a.jsxs)("div",{className:"card animate-fade-in",children:[a.jsx("h3",{className:"mb-4",children:"\uD83D\uDCDD 步驟 2：上傳您的論文"}),(0,a.jsxs)("div",{style:{padding:"1rem",background:"var(--primary-50)",borderRadius:"var(--radius)",marginBottom:"1.5rem"},children:[(0,a.jsxs)("div",{style:{fontWeight:"600",marginBottom:"0.25rem"},children:["已選擇範本：",g.name]}),a.jsx("div",{style:{fontSize:"0.875rem",color:"var(--gray-500)"},children:g.description})]}),y?(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"file-item",style:{marginBottom:"1.5rem"},children:[a.jsx("div",{className:"file-icon",children:y.filename.toLowerCase().endsWith(".pdf")?"PDF":"DOCX"}),(0,a.jsxs)("div",{className:"file-info",children:[a.jsx("div",{className:"file-name",children:y.filename}),(0,a.jsxs)("div",{className:"file-meta",children:[(e=y.file_size)<1024?`${e} B`:e<1048576?`${(e/1024).toFixed(1)} KB`:`${(e/1048576).toFixed(1)} MB`," \xb7 ",y.page_count," 頁"]})]}),a.jsx("span",{className:"status-badge status-uploaded",children:"已上傳"})]}),(0,a.jsxs)("div",{style:{display:"flex",gap:"1rem",justifyContent:"center"},children:[a.jsx("button",{className:"btn btn-secondary",onClick:()=>{b(null),m(0)},children:"重新上傳"}),a.jsx("button",{className:"btn btn-primary",onClick:$,disabled:N,children:N?"處理中...":"開始套用格式 →"})]})]}):(0,a.jsxs)("div",{className:`upload-zone ${n?"drag-over":""}`,onDragOver:P,onDragLeave:_,onDrop:S,onClick:()=>w.current?.click(),children:[a.jsx("input",{ref:w,type:"file",accept:".pdf,.docx,.doc",onChange:I,style:{display:"none"}}),d?(0,a.jsxs)("div",{children:[a.jsx("div",{className:"upload-icon animate-spin",children:"\uD83D\uDCE4"}),a.jsx("h3",{className:"upload-title",children:"正在上傳論文..."}),a.jsx("div",{className:"progress-bar",style:{maxWidth:"300px",margin:"1rem auto"},children:a.jsx("div",{className:"progress-fill",style:{width:`${c}%`}})})]}):(0,a.jsxs)("div",{children:[a.jsx("div",{className:"upload-icon",children:"\uD83D\uDCDD"}),a.jsx("h3",{className:"upload-title",children:"上傳您的論文"}),a.jsx("p",{className:"upload-subtitle",children:"支援 PDF 或 Word (.docx)"})]})]}),a.jsx("button",{className:"btn btn-secondary mt-4",onClick:()=>{t("template"),v(null)},style:{width:"100%"},children:"← 返回選擇範本"})]}),"processing"===s&&(0,a.jsxs)("div",{className:"card animate-fade-in text-center",style:{padding:"3rem 2rem"},children:[a.jsx("div",{style:{fontSize:"4rem"},className:"animate-spin",children:"⚙️"}),a.jsx("h3",{className:"mt-4",children:"正在套用格式..."}),a.jsx("p",{style:{color:"var(--gray-500)"},children:"系統正在根據範本調整您的論文格式，請稍候"})]})]})}},2917:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>i,metadata:()=>r});var a=t(5036);t(7272);let r={title:"論文格式調整系統",description:"自動將您的論文調整為符合學校規定的格式",keywords:["論文","格式調整","排版","學術論文"]};function i({children:e}){return(0,a.jsxs)("html",{lang:"zh-TW",children:[(0,a.jsxs)("head",{children:[a.jsx("link",{rel:"preconnect",href:"https://fonts.googleapis.com"}),a.jsx("link",{rel:"preconnect",href:"https://fonts.gstatic.com",crossOrigin:"anonymous"}),a.jsx("link",{href:"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap",rel:"stylesheet"})]}),a.jsx("body",{children:(0,a.jsxs)("div",{className:"page-wrapper",children:[a.jsx("header",{className:"header",children:(0,a.jsxs)("div",{className:"container header-content",children:[(0,a.jsxs)("a",{href:"/",className:"logo",children:[a.jsx("span",{className:"logo-icon",children:"\uD83D\uDCC4"}),a.jsx("span",{children:"論文格式調整系統"})]}),(0,a.jsxs)("nav",{className:"nav-links",children:[a.jsx("a",{href:"/",className:"nav-link",children:"首頁"}),a.jsx("a",{href:"/upload",className:"nav-link",children:"上傳文件"}),a.jsx("a",{href:"/documents",className:"nav-link",children:"我的文件"})]})]})}),a.jsx("main",{className:"main-content",children:e}),a.jsx("footer",{className:"footer",children:(0,a.jsxs)("div",{className:"container footer-content",children:[a.jsx("p",{className:"footer-text",children:"\xa9 2026 論文格式調整系統 — Spec v1"}),a.jsx("p",{className:"footer-text",children:"讓您的論文格式完美符合學校規定"})]})})]})})]})}},1453:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>i,__esModule:()=>r,default:()=>n});let a=(0,t(6843).createProxy)(String.raw`/Users/wangchunhao/github /AI-Thesis-Formatter/frontend/app/upload/page.tsx`),{__esModule:r,$$typeof:i}=a,n=a.default},7272:()=>{}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[22],()=>t(6502));module.exports=a})();